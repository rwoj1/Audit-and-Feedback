<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Deprescribing Taper Scheduler</title>
  <link rel="stylesheet" href="styles.css"/>
  <!-- PDF export (client-side) -->
  <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
</head>
<body>
  <header class="site-header">
    <h1>Deprescribing Taper Scheduler</h1>
    <p class="subtitle">Build a stepwise taper with label-style instructions that follow the Australian standard.</p>
  </header>

  <main class="container">
    <!-- Inputs -->
    <section class="card">
      <h2>Medicine Chart Input</h2>
      <div class="grid">
        <label>Medicine Class
          <select id="classSelect"></select>
        </label>

        <label>Medicine
          <select id="medicineSelect"></select>
        </label>

        <label>Form
          <select id="formSelect"></select>
        </label>

        <label>Strength
          <select id="strengthSelect"></select>
        </label>

        <label>Frequency
          <select id="frequencySelect">
            <option value="1">Daily</option>
            <option value="2">Twice daily</option>
            <option value="3">Three times daily</option>
            <option value="4">Four times a day</option>
          </select>
        </label>

        <label>How long have you been on this medicine?
          <select id="durationSelect">
            <option value="<3">&lt; 3 months</option>
            <option value=">3">&gt; 3 months</option>
          </select>
        </label>

        <label>Start date
          <input id="startDate" type="date"/>
        </label>

        <label>Next review date (optional)
          <input id="reviewDate" type="date"/>
        </label>

        <label>Preset (class-based)
          <select id="presetSelect">
            <option value="custom" selected>Custom (manual controls below)</option>
            <option value="bzra">BZRA taper (typical ~25% q2w; 12.5% near end)</option>
            <option value="ap">Antipsychotic taper (25–50% q1–2w)</option>
            <option value="ppi_stepdown">PPI: Step-down</option>
            <option value="ppi_ondemand">PPI: Stop & on-demand</option>
          </select>
        </label>
      </div>

      <!-- Two-phase taper controls (no auto pre-fill; presets only show guidance text) -->
      <fieldset class="phases">
        <legend>Dose reduction controls (optional)</legend>
        <div class="grid">
          <label>Phase 1 % reduction
            <input id="p1Percent" type="number" min="1" max="50" step="0.5" placeholder="e.g., 25">
          </label>
          <label>Phase 1 interval (days)
            <input id="p1Interval" type="number" min="1" step="1" placeholder="e.g., 14">
          </label>
          <label>Stop Phase 1 when dose ≤ (mg)
            <input id="p1StopDose" type="number" min="0" step="0.1" placeholder="e.g., 25">
          </label>

          <label>Phase 2 % reduction
            <input id="p2Percent" type="number" min="1" max="50" step="0.5" placeholder="e.g., 12.5">
          </label>
          <label>Phase 2 interval (days)
            <input id="p2Interval" type="number" min="1" step="1" placeholder="e.g., 14">
          </label>
        </div>
        <p class="hint">Leave blank to use a single-phase taper (the “Reduce by” + “every” controls aren’t shown; use these fields instead).</p>
      </fieldset>

      <div class="actions">
        <button id="generateBtn">Generate Chart</button>
        <button id="printBtn" class="secondary">Print</button>
        <button id="pdfBtn" class="secondary">Save as PDF</button>
        <button id="resetBtn" class="tertiary">Reset</button>
      </div>
    </section>

    <!-- Plain-English best-practice guidance (triggered by Duration select) -->
    <section class="card">
      <h2>Best-practice guidance (plain English)</h2>
      <div id="guidanceBlock" class="advice small"></div>
      <p class="tiny-note">Dose wording uses explicit times of day (e.g., “Take 1 tablet in the morning”), per the national standard. :contentReference[oaicite:2]{index=2}</p>
    </section>

    <!-- Patient & header info -->
    <section class="card">
      <h2>Patient & Safety Details</h2>
      <div class="grid">
        <label>Patient name
          <input id="patientName" type="text" placeholder="e.g., Alex Smith"/>
        </label>
        <label>Allergies
          <input id="allergies" type="text" placeholder="e.g., NKDA"/>
        </label>
        <label>Health professional
          <input id="hcpName" type="text" placeholder="e.g., Dr Patel / Pharmacist Jones"/>
        </label>
      </div>
      <p class="hint">Header will display: PATIENT • ALLERGIES • HCP • MEDICINE (e.g., “Morphine Tablet”). No class or strength in this header.</p>
    </section>

    <!-- Output -->
    <section class="card">
      <h2>Generated Taper Plan</h2>
      <div id="scheduleBlock" class="schedule-wrapper"></div>

      <details class="images-note">
        <summary>Your tablet may look like… (images)</summary>
        <p>Put images in <code>/images</code> as <code>medicine_strength.jpg</code> (e.g., <code>diazepam_5mg.jpg</code>). The app will try to show a matching image for each row.</p>
      </details>
    </section>
  </main>

  <footer class="site-footer">
    <p><strong>Labelling & wording</strong>: Instructions use explicit times and simple text (e.g., “Take 1 tablet in the morning”), per the National standard for labelling dispensed medicines. :contentReference[oaicite:3]{index=3}</p>
    <p>For education/clinical support only. Not for commercial use.</p>
  </footer>

  <script src="script.js"></script>
</body>
</html>
